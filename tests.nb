fails = 0;




(* MAPPING & COMMA-BASIS UTILITIES *)


(* dimensionality *)
If[dimensionality[{{0}}] != 1, fails = fails + 1; Print["dimensionality[{{0}}] != 1"]];
If[dimensionality[{{0, 0}}] == 2, "", fails = fails + 1; Print["dimensionality[{{0, 0}}] == 2"]];
If[dimensionality[{{0}, {0}}] == 2, "", fails = fails + 1; Print["dimensionality[{{0}, {0}}] == 2"]];
If[dimensionality[IdentityMatrix[2]] == 2, "", fails = fails + 1; Print["dimensionality[IdentityMatrix[2]] == 2"]];
If[dimensionality[{{1, 0, -4}, {0, 1, 4}}] == 3, "", fails = fails + 1; Print["dimensionality[{{1, 0, -4}, {0, 1, 4}}] == 3"]];
If[dimensionality[{{4}, {-4}, {1}}] == 3, "", fails = fails + 1; Print["dimensionality[{{4}, {-4}, {1}}] == 3"]];
If[dimensionality[{{1, 0, -4, 0}, {0, 1, 4, 0}}] == 4, "", fails = fails + 1; Print["dimensionality[{{1, 0, -4, 0}, {0, 1, 4, 0}}] == 4"]];
If[dimensionality[{{4}, {-4}, {1}, {0}}] == 4, "", fails = fails + 1; Print["dimensionality[{{4}, {-4}, {1}, {0}}] == 4"]];

(* rank *)
If[rank[{{0}}] == Error, "", fails = fails + 1; Print["rank[{{0}}] == Error"]];
If[rank[{{0, 0}}] == 0, "", fails = fails + 1; Print["rank[{{0, 0}}] == 0"]];
If[rank[{{0}, {0}}] == 2, "", fails = fails + 1; Print["rank[{{0}, {0}}] == 2"]];
If[rank[IdentityMatrix[2]] == Error, "", fails = fails + 1; Print["rank[IdentityMatrix[2]] == Error"]];
If[rank[{{1, 0, -4}, {0, 1, 4}}] == 2, "", fails = fails + 1; Print["rank[{{1, 0, -4}, {0, 1, 4}}] == 2"]];
If[rank[{{4}, {-4}, {1}}] == 2, "", fails = fails + 1; Print["rank[{{4}, {-4}, {1}}] == 2"]];
If[rank[{{1, 0, -4, 0}, {0, 1, 4, 0}}] == 2, "", fails = fails + 1; Print["rank[{{1, 0, -4, 0}, {0, 1, 4, 0}}] == 2"]];
If[rank[{{4}, {-4}, {1}, {0}}] == 3, "", fails = fails + 1; Print["rank[{{4}, {-4}, {1}, {0}}] == 3"]];

(* nullity *)
If[nullity[{{0}}] == Error, "", fails = fails + 1; Print["nullity[{{0}}] == Error"]];
If[nullity[{{0, 0}}] == 2, "", fails = fails + 1; Print["nullity[{{0, 0}}] == 2"]];
If[nullity[{{0}, {0}}] == 0, "", fails = fails + 1; Print["nullity[{{0}, {0}}] == 0"]];
If[nullity[IdentityMatrix[2]] == Error, "", fails = fails + 1; Print["nullity[IdentityMatrix[2]] == Error"]];
If[nullity[{{1, 0, -4}, {0, 1, 4}}] == 1, "", fails = fails + 1; Print["nullity[{{1, 0, -4}, {0, 1, 4}}] == 1"]];
If[nullity[{{4}, {-4}, {1}}] == 1, "", fails = fails + 1; Print["nullity[{{4}, {-4}, {1}}] == 1"]];
If[nullity[{{1, 0, -4, 0}, {0, 1, 4, 0}}] == 2, "", fails = fails + 1; Print["nullity[{{1, 0, -4, 0}, {0, 1, 4, 0}}] == 2"]];
If[nullity[{{4}, {-4}, {1}, {0}}] == 1, "", fails = fails + 1; Print["nullity[{{4}, {-4}, {1}, {0}}] == 1"]];


(* MATRIX FORMS & DEFACTORING *)

(* canonicalForm *)
If[canonicalForm[{{12, 19}, {0, 0}, {0, 0}}] == {{1}, {0}, {0}}, "", fails = fails + 1; Print["canonicalForm[{{12, 19}, {0, 0}, {0, 0}}] == {{1}, {0}, {0}}"]];
If[canonicalForm[{{1, 1, 0}, {0, 1, 4}}] == {{1, 0, -4}, {0, 1, 4}}, "", fails = fails + 1; Print["canonicalForm[{{1, 1, 0}, {0, 1, 4}}] == {{1, 0, -4}, {0, 1, 4}}"]];
If[canonicalForm[{{12, 19, 28}}] == {{12, 19, 28}}, "", fails = fails + 1; Print["canonicalForm[{{12, 19, 28}}] == {{12, 19, 28}}"]];
If[canonicalForm[{{7, 11, 16}, {22, 35, 51}}] == {{1, 2, 3}, {0, 3, 5}}, "", fails = fails + 1; Print["canonicalForm[{{7, 11, 16}, {22, 35, 51}}] == {{1, 2, 3}, {0, 3, 5}}"]];
If[canonicalForm[{{3, 0, -1}, {0, 3, 5}}] == {{1, 2, 3}, {0, 3, 5}}, "", fails = fails + 1; Print["canonicalForm[{{3, 0, -1}, {0, 3, 5}}] == {{1, 2, 3}, {0, 3, 5}}"]];
If[canonicalForm[{{1, 2, 3}, {0, 3, 5}}] == {{1, 2, 3}, {0, 3, 5}}, "", fails = fails + 1; Print["canonicalForm[{{1, 2, 3}, {0, 3, 5}}] == {{1, 2, 3}, {0, 3, 5}}"]];
If[canonicalForm[{{0, 1, 4, 10}, {1, 0, -4, -13}}] == {{1, 0, -4, -13}, {0, 1, 4, 10}}, "", fails = fails + 1; Print["canonicalForm[{{0, 1, 4, 10}, {1, 0, -4, -13}}] == {{1, 0, -4, -13}, {0, 1, 4, 10}}"]];
If[canonicalForm[{{10, 13, 12, 0}, {-1, -1, 0, 3}}] == {{1, 0, -4, -13}, {0, 1, 4, 10}}, "", fails = fails + 1; Print["canonicalForm[{{10, 13, 12, 0}, {-1, -1, 0, 3}}] == {{1, 0, -4, -13}, {0, 1, 4, 10}}"]];
If[canonicalForm[{{5, 8, 0}, {0, 0, 1}}] == {{5, 8, 0}, {0, 0, 1}}, "", fails = fails + 1; Print["canonicalForm[{{5, 8, 0}, {0, 0, 1}}] == {{5, 8, 0}, {0, 0, 1}}"]];
If[canonicalForm[{{2, 0, 11, 12}, {0, 1, -2, -2}}] == {{2, 0, 11, 12}, {0, 1, -2, -2}}, "", fails = fails + 1; Print["canonicalForm[{{2, 0, 11, 12}, {0, 1, -2, -2}}] == {{2, 0, 11, 12}, {0, 1, -2, -2}}"]];
If[canonicalForm[{{1, 0, 0, -5}, {0, 1, 0, 2}, {0, 0, 1, 2}}] == {{1, 0, 0, -5}, {0, 1, 0, 2}, {0, 0, 1, 2}}, "", fails = fails + 1; Print["canonicalForm[{{1, 0, 0, -5}, {0, 1, 0, 2}, {0, 0, 1, 2}}] == {{1, 0, 0, -5}, {0, 1, 0, 2}, {0, 0, 1, 2}}"]];
If[canonicalForm[{{1, 0, 0, -5, 12}, {0, 1, 0, 2, -1}, {0, 0, 1, 2, -3}}] == {{1, 0, 0, -5, 12}, {0, 1, 0, 2, -1}, {0, 0, 1, 2, -3}}, "", fails = fails + 1; Print["canonicalForm[{{1, 0, 0, -5, 12}, {0, 1, 0, 2, -1}, {0, 0, 1, 2, -3}}] == {{1, 0, 0, -5, 12}, {0, 1, 0, 2, -1}, {0, 0, 1, 2, -3}}"]];
If[canonicalForm[{{12, 19, 28}, {26, 43, 60}}] == {{1, 8, 0}, {0, 11, -4}}, "", fails = fails + 1; Print["canonicalForm[{{12, 19, 28}, {26, 43, 60}}] == {{1, 8, 0}, {0, 11, -4}}"]];
If[canonicalForm[{{17, 16, -4}, {4, -4, 1}}] == {{1, 0, 0}, {0, 4, -1}}, "", fails = fails + 1; Print["canonicalForm[{{17, 16, -4}, {4, -4, 1}}] == {{1, 0, 0}, {0, 4, -1}}"]];
If[canonicalForm[{{6, 5, -4}, {4, -4, 1}}] == {{2, 1, -1}, {0, 2, -1}}, "", fails = fails + 1; Print["canonicalForm[{{6, 5, -4}, {4, -4, 1}}] == {{2, 1, -1}, {0, 2, -1}}"]];
If[canonicalForm[{{12, 19, 28}, {0, 0, 0}}] == {{12, 19, 28}}, "", fails = fails + 1; Print["canonicalForm[{{12, 19, 28}, {0, 0, 0}}] == {{12, 19, 28}}"]];
If[canonicalForm[{{1, 0, 0, -5}, {0, 1, 0, 2}, {1, 1, 0, -3}}] == {{1, 0, 0, -5}, {0, 1, 0, 2}}, "", fails = fails + 1; Print["canonicalForm[{{1, 0, 0, -5}, {0, 1, 0, 2}, {1, 1, 0, -3}}] == {{1, 0, 0, -5}, {0, 1, 0, 2}}"]];
If[canonicalForm[{{0, 0}}] == {{0, 0}}, "", fails = fails + 1; Print["canonicalForm[{{0, 0}}] == {{0, 0}}"]];
If[canonicalForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}] == {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}, "", fails = fails + 1; Print["canonicalForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}] == {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}"]];
If[canonicalForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}, "mapping"] == {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}, "", fails = fails + 1; Print["canonicalForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}, "mapping"] == {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}"]];
If[canonicalForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}, "commaBasis"] == {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}, "", fails = fails + 1; Print["canonicalForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}, "commaBasis"] == {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}"]];
If[canonicalForm[{{1, 0, -4}, {0, 1, 4}, {0, 0, 0}}, "mapping"] == {{1, 0, -4}, {0, 1, 4}}, "", fails = fails + 1; Print["canonicalForm[{{1, 0, -4}, {0, 1, 4}, {0, 0, 0}}, "mapping"] == {{1, 0, -4}, {0, 1, 4}}"]];
If[canonicalForm[{{4, 0, 0}, {-4, 0, 0}, {1, 0, 0}}, "commaBasis"] == {{4}, {-4}, {1}}, "", fails = fails + 1; Print["canonicalForm[{{4, 0, 0}, {-4, 0, 0}, {1, 0, 0}}, "commaBasis"] == {{4}, {-4}, {1}}"]];
If[canonicalForm[{{12, 19, 28, 0}}] == {{12, 19, 28, 0}}, "", fails = fails + 1; Print["canonicalForm[{{12, 19, 28, 0}}] == {{12, 19, 28, 0}}"]];
If[canonicalForm[{{0, 0, 0}, {0, 0, 0}}] == {{0, 0, 0}}, "", fails = fails + 1; Print["canonicalForm[{{0, 0, 0}, {0, 0, 0}}] == {{0, 0, 0}}"]];


(* DUAL *)

(* nullSpaceBasis *)
If[nullSpaceBasis[{{1, 0, -4}, {0, 1, 4}}] == {{4}, {-4}, {1}}, "", fails = fails + 1; Print["nullSpaceBasis[{{1, 0, -4}, {0, 1, 4}}] == {{4}, {-4}, {1}}"]];
If[nullSpaceBasis[{{0}}] == IdentityMatrix[1], "", fails = fails + 1; Print["nullSpaceBasis[{{0}}] == IdentityMatrix[1]"]];
If[nullSpaceBasis[{{0, 0}}] == IdentityMatrix[2], "", fails = fails + 1; Print["nullSpaceBasis[{{0, 0}}] == IdentityMatrix[2]"]];
If[nullSpaceBasis[{{0, 0, 0}}] == IdentityMatrix[3], "", fails = fails + 1; Print["nullSpaceBasis[{{0, 0, 0}}] == IdentityMatrix[3]"]];
If[nullSpaceBasis[IdentityMatrix[3]] == {{0}, {0}, {0}}, "", fails = fails + 1; Print["nullSpaceBasis[IdentityMatrix[3]] == {{0}, {0}, {0}}"]];

(* antiNullSpaceBasis *)
If[antiNullSpaceBasis[{{4}, {-4}, {1}}] == {{1, 0, -4}, {0, 1, 4}}, "", fails = fails + 1; Print["antiNullSpaceBasis[{{4}, {-4}, {1}}] == {{1, 0, -4}, {0, 1, 4}}"]];
If[antiNullSpaceBasis[{{1, 0}, {0, -4}, {0, 9}}] == {{0, 9, 4}}, "", fails = fails + 1; Print["antiNullSpaceBasis[{{1, 0}, {0, -4}, {0, 9}}] == {{0, 9, 4}}"]];
If[antiNullSpaceBasis[{{0}}] == IdentityMatrix[1], "", fails = fails + 1; Print["antiNullSpaceBasis[{{0}}] == IdentityMatrix[1]"]];
If[antiNullSpaceBasis[{{0}, {0}}] == IdentityMatrix[2], "", fails = fails + 1; Print["antiNullSpaceBasis[{{0}, {0}}] == IdentityMatrix[2]"]];
If[antiNullSpaceBasis[{{0}, {0}, {0}}] == IdentityMatrix[3], "", fails = fails + 1; Print["antiNullSpaceBasis[{{0}, {0}, {0}}] == IdentityMatrix[3]"]];
If[antiNullSpaceBasis[IdentityMatrix[3]] == {{0, 0, 0}}, "", fails = fails + 1; Print["antiNullSpaceBasis[IdentityMatrix[3]] == {{0, 0, 0}}"]];

(* dual *)
verifyDuals[m_, c_] := Module[{dualM, dualC},
  dualC = dual[m, "mapping"];
  dualM = dual[c, "commaBasis"];

  If[dualC == canonicalForm[c] && dualM == canonicalForm[m], "", fails = fails + 1; Print["verifyDuals[", m, ", ", c, "]; dualC: ", dualC, " canonicalForm[c]: ", canonicalForm[c], " dualM: ", dualM, " canonicalForm[m]: ", canonicalForm[m]]];
];

verifyDuals[{{1, 0, -4}, {0, 1, 4}}, {{4}, {-4}, {1}}];
verifyDuals[{{0}}, {{1}}];
verifyDuals[{{0, 0}}, {{1, 0}, {0, 1}}];
verifyDuals[{{0, 0, 0}}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}];
verifyDuals[{{1}}, {{0}}];
verifyDuals[{{1, 0}, {0, 1}}, {{0}, {0}}];
verifyDuals[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}, {{0}, {0}, {0}}];
verifyDuals[{{12, 19}}, {{-19}, {12}}];


(* MEET AND JOIN *)


(* basic examples *)

et5M5 = {{5, 8, 12}};
et5C5 = {{-8, -4}, {5, 1}, {0, 1}};
et7M5 = {{7, 11, 16}};
et7C5 = {{-11, -7}, {7, 3}, {0, 1}};
meantoneM5 = {{1, 0, -4}, {0, 1, 4}};
meantoneC5 = {{4}, {-4}, {1}};
porcupineM5 = {{1, 2, 3}, {0, 3, 5}};
porcupineC5 = {{1}, {-5}, {3}};

If[et5M5 == dual[et5C5], "", fails = fails + 1; Print["et5M5 == dual[et5C5]"]];
If[et7M5 == dual[et7C5], "", fails = fails + 1; Print["et7M5 == dual[et7C5]"]];
If[meantoneM5 == dual[meantoneC5], "", fails = fails + 1; Print["meantoneM5 == dual[meantoneC5]"]];
If[porcupineM5 == dual[porcupineC5], "", fails = fails + 1; Print["porcupineM5 == dual[porcupineC5]"]];

If[join[{et5M5, et7M5}] == meantoneM5, "", fails = fails + 1; Print["join[{et5M5, et7M5}] == meantoneM5"]];
If[meet[{meantoneC5, porcupineC5}] == et7C5, "", fails = fails + 1; Print["meet[{meantoneC5, porcupineC5}] == et7C5"]];

(* prove out that you can specify temperaments by either their mappings or their comma-bases *)

If[join[{et5M5, et7C5}] == meantoneM5, "", fails = fails + 1; Print["join[{et5M5, et7C5}] == meantoneM5"]];
If[meet[{meantoneM5, porcupineC5}] == et7C5, "", fails = fails + 1; Print["meet[{meantoneM5, porcupineC5}] == et7C5"]];
If[join[{et5C5, et7M5}] == meantoneM5, "", fails = fails + 1; Print["join[{et5C5, et7M5}] == meantoneM5"]];
If[meet[{meantoneC5, porcupineM5}] == et7C5, "", fails = fails + 1; Print["meet[{meantoneC5, porcupineM5}] == et7C5"]];
If[join[{et5C5, et7C5}] == meantoneM5, "", fails = fails + 1; Print["join[{et5C5, et7C5}] == meantoneM5"]];
If[meet[{meantoneM5, porcupineM5}] == et7C5, "", fails = fails + 1; Print["meet[{meantoneM5, porcupineM5}] == et7C5"]];


(* prove out that you can meet or join more than 2 temperaments at a time *)

et7dLimit7 = {{7, 11, 16, 19}};
et12Limit7 = {{12, 19, 28, 34}};
et22Limit7 = {{22, 35, 51, 62}};
marvel = {{1, 0, 0, -5}, {0, 1, 0, 2}, {0, 0, 1, 2}};
If[join[{et7dLimit7, et12Limit7, et22Limit7}] == marvel, "", fails = fails + 1; Print["join[{et7dLimit7, et12Limit7, et22Limit7}] == marvel"]];

mintComma = {{2}, {2}, {-1}, {-1}};
meantoneComma = {{4}, {-4}, {1}, {0}};
negriComma = {{-14}, {3}, {4}, {0}};
et19dC7 = nullSpaceBasis[{{19, 30, 44, 54}}];
If[meet[{mintComma, meantoneComma, negriComma}] == et19dC7, "", fails = fails + 1; Print["meet[{mintComma, meantoneComma, negriComma}] == et19dC7"]];


(* examples from Meet and Join page *)

meantoneM11 = {{1, 0, -4, -13, -25}, {0, 1, 4, 10, 18}};
meantoneC11 = {{-4, 1, -1}, {4, 2, 2}, {-1, -3, 0}, {0, 1, -2}, {0, 0, 1}};
meanpopM11 = {{1, 0, -4, -13, 24}, {0, 1, 4, 10, -13}};
meanpopC11 = {{-4, 1, -7}, {4, 2, -1}, {-1, -3, 1}, {0, 1, 1}, {0, 0, 1}};
marvelM11 = {{1, 0, 0, -5, 12}, {0, 1, 0, 2, -1}, {0, 0, 1, 2, -3}};
marvelC11 = {{-5, -7}, {2, -1}, {2, 1}, {-1, 1}, {0, 1}};
porcupineM11 = {{1, 2, 3, 2, 4}, {0, 3, 5, -6, 4}};
porcupineC11 = {{-1, 6, 2}, {-3, -2, -2}, {1, 0, 2}, {0, -1, 0}, {1, 0, -1}};
et31M11 = {{31, 49, 72, 87, 107}};
et31C11 = {{-49, -45, -36, -24}, {31, 27, 21, 13}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}};
meantoneM7 = {{1, 0, -4, -13}, {0, 1, 4, 10}};
meantoneC7 = {{4, 1}, {-4, 2}, {1, -3}, {0, 1}};
porcupineM7 = {{1, 2, 3, 2}, {0, 3, 5, -6}};
porcupineC7 = {{6, 1}, {-2, -5}, {0, 3}, {-1, 0}};
miracleM11 = {{1, 1, 3, 3, 2}, {0, 6, -7, -2, 15}};
miracleC11 = {{-5, -1, -7}, {2, 5, -1}, {2, 0, 1}, {-1, 0, 1}, {0, -2, 1}};
magicM11 = {{1, 0, 2, -1, 6}, {0, 5, 1, 12, -8}};
magicC11 = {{-5, 0, 2}, {2, -5, -2}, {2, 1, 2}, {-1, 2, 0}, {0, 0, -1}};
et41M11 = {{41, 65, 95, 115, 142}};
et41C11 = {{-65, -15, -25, -32}, {41, 8, 14, 18}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}};
miracleM7 = {{1, 1, 3, 3}, {0, 6, -7, -2}};
miracleC7 = {{-5, -10}, {2, 1}, {2, 0}, {-1, 3}};
magicM7 = {{1, 0, 2, -1}, {0, 5, 1, 12}};
magicC7 = {{-5, 0}, {2, -5}, {2, 1}, {-1, 2}};
et41M7 = {{41, 65, 95, 115}};
et41C7 = {{-65, -15, -25}, {41, 8, 14}, {0, 1, 0}, {0, 0, 1}};
mothraM11 = {{1, 1, 0, 3, 5}, {0, 3, 12, -1, -8}};
mothraC11 = {{-4, -1, -7}, {4, 2, -1}, {-1, 0, 1}, {0, -2, 1}, {0, 1, 1}};
mothraM7 = {{1, 1, 0, 3}, {0, 3, 12, -1}};
mothraC7 = {{-4, -10}, {4, 1}, {-1, 0}, {0, 3}};
portentM11 = {{1, 1, 0, 3, 5}, {0, 3, 0, -1, 4}, {0, 0, 1, 0, -1}};
portentC11 = {{-7, -3}, {-1, 2}, {1, -1}, {1, 2}, {1, -1}};
gamelanM7 = {{1, 1, 0, 3}, {0, 3, 0, -1}, {0, 0, 1, 0}};
gamelanC7 = {{-10}, {1}, {0}, {3}};
marvelM7 = {{1, 0, 0, -5}, {0, 1, 0, 2}, {0, 0, 1, 2}};
marvelC7 = {{-5}, {2}, {2}, {-1}};

If[meantoneM11 == dual[meantoneC11], "", fails = fails + 1; Print["meantoneM11 == dual[meantoneC11]"]];
If[meanpopM11 == dual[meanpopC11], "", fails = fails + 1; Print["meanpopM11 == dual[meanpopC11]"]];
If[marvelM11 == dual[marvelC11], "", fails = fails + 1; Print["marvelM11 == dual[marvelC11]"]];
If[porcupineM11 == dual[porcupineC11], "", fails = fails + 1; Print["porcupineM11 == dual[porcupineC11]"]];
If[et31M11 == dual[et31C11], "", fails = fails + 1; Print["et31M11 == dual[et31C11]"]];
If[meantoneM7 == dual[meantoneC7], "", fails = fails + 1; Print["meantoneM7 == dual[meantoneC7]"]];
If[porcupineM7 == dual[porcupineC7], "", fails = fails + 1; Print["porcupineM7 == dual[porcupineC7]"]];
If[miracleM11 == dual[miracleC11], "", fails = fails + 1; Print["miracleM11 == dual[miracleC11]"]];
If[magicM11 == dual[magicC11], "", fails = fails + 1; Print["magicM11 == dual[magicC11]"]];
If[et41M11 == dual[et41C11], "", fails = fails + 1; Print["et41M11 == dual[et41C11]"]];
If[miracleM7 == dual[miracleC7], "", fails = fails + 1; Print["miracleM7 == dual[miracleC7]"]];
If[magicM7 == dual[magicC7], "", fails = fails + 1; Print["magicM7 == dual[magicC7]"]];
If[et41M7 == dual[et41C7], "", fails = fails + 1; Print["et41M7 == dual[et41C7]"]];
If[mothraM11 == dual[mothraC11], "", fails = fails + 1; Print["mothraM11 == dual[mothraC11]"]];
If[mothraM7 == dual[mothraC7], "", fails = fails + 1; Print["mothraM7 == dual[mothraC7]"]];
If[portentM11 == dual[portentC11], "", fails = fails + 1; Print["portentM11 == dual[portentC11]"]];
If[gamelanM7 == dual[gamelanC7], "", fails = fails + 1; Print["gamelanM7 == dual[gamelanC7]"]];
If[marvelM7 == dual[marvelC7], "", fails = fails + 1; Print["marvelM7 == dual[marvelC7]"]];

(*⋎ = MEET, ⋏ = JOIN *)

(*Meantone⋎Meanpop = [<31 49 72 87 107|] = 31, where "31" is the shorthand notation for the 31edo patent val.*)
If[meet[{meantoneC11, meanpopC11}] == et31C11, "", fails = fails + 1; Print["meet[{meantoneC11, meanpopC11}] == et31C11"]];

(*Meantone⋏Meanpop = [<1 0 -4 -13 0|, <0 1 4 10 0|, <0 0 0 0 1|] = <81/80, 126/125>*)
If[join[{meantoneM11, meanpopM11}] == {{1, 0, -4, -13, 0}, {0, 1, 4, 10, 0}, {0, 0, 0, 0, 1}}, "", fails = fails + 1; Print["join[{meantoneM11, meanpopM11}] == {{1, 0, -4, -13, 0}, {0, 1, 4, 10, 0}, {0, 0, 0, 0, 1}}"]];

(*Meantone⋎Marvel = 31*)
If[meet[{meantoneC11, marvelC11}] == et31C11, "", fails = fails + 1; Print["meet[{meantoneC11, marvelC11}] == et31C11"]];

(*Meantone⋏Marvel = <225/224>*)
If[join[{meantoneM11, marvelM11}] == antiNullSpaceBasis[{{-5}, {2}, {2}, {-1}, {0}}], "", fails = fails + 1; Print["join[{meantoneM11, marvelM11}] == antiNullSpaceBasis[{{-5}, {2}, {2}, {-1}, {0}}]"]];

(*Meantone⋎Porcupine = G = <JI>*)
If[meet[{meantoneC11, porcupineC11}] == IdentityMatrix[5], "", fails = fails + 1; Print["meet[{meantoneC11, porcupineC11}] == IdentityMatrix[5]"]];

(*Meantone⋏Porcupine = <176/175>*)
If[join[{meantoneM11, porcupineM11}] == antiNullSpaceBasis[{{4}, {0}, {-2}, {-1}, {1}}], "", fails = fails + 1; Print["join[{meantoneM11, porcupineM11}] == antiNullSpaceBasis[{{4}, {0}, {-2}, {-1}, {1}}]"]];

(*In the 7-limit, that become Meantone⋎Porcupine = <JI>, Meantone⋏Porcupine = <1>*)
If[meet[{meantoneC7, porcupineC7}] == IdentityMatrix[4], "", fails = fails + 1; Print["meet[{meantoneC7, porcupineC7}] == IdentityMatrix[4]"]];
If[join[{meantoneM7, porcupineM7}] == IdentityMatrix[4], "", fails = fails + 1; Print["join[{meantoneM7, porcupineM7}] == IdentityMatrix[4]"]];

(*Miracle⋎Magic = 41 *)
If[meet[{miracleC11, magicC11}] == et41C11, "", fails = fails + 1; Print["meet[{miracleC11, magicC11}] == et41C11"]];

(*Miracle⋏Magic = Marvel *)
If[join[{miracleM11, magicM11}] == marvelM11, "", fails = fails + 1; Print["join[{miracleM11, magicM11}] == marvelM11"]];

(*In the 7-limit, again Miracle⋎Magic = 41, Miracle⋏Magic = Marvel*)
If[meet[{miracleC7, magicC7}] == et41C7, "", fails = fails + 1; Print["meet[{miracleC7, magicC7}] == et41C7"]];
If[join[{miracleM7, magicM7}] == marvelM7, "", fails = fails + 1; Print["join[{miracleM7, magicM7}] == marvelM7"]];

(*Miracle⋎Mothra = 31 *)
If[meet[{miracleC11, mothraC11}] == et31C11, "", fails = fails + 1; Print["meet[{miracleC11, mothraC11}] == et31C11"]];

(* Miracle⋏Mothra = Portent *)
If[join[{miracleM11, mothraM11}] == portentM11, "", fails = fails + 1; Print["join[{miracleM11, mothraM11}] == portentM11"]];

(*In the 7-limit, Miracle⋏Mothra = Gamelan.*)
If[join[{miracleM7, mothraM7}] == gamelanM7, "", fails = fails + 1; Print["join[{miracleM7, mothraM7}] == gamelanM7"]];

(*Meantone⋎Magic = <JI>,*)
If[meet[{meantoneC11, magicC11}] == IdentityMatrix[5], "", fails = fails + 1; Print["meet[{meantoneC11, magicC11}] == IdentityMatrix[5]"]];

(*Meantone⋏Magic = <225/224>*)
If[join[{meantoneM11, magicM11}] == antiNullSpaceBasis[{{-5}, {2}, {2}, {-1}, {0}}], "", fails = fails + 1; Print["join[{meantoneM11, magicM11}] == antiNullSpaceBasis[{{-5}, {2}, {2}, {-1}, {0}}]"]];


(* GENERATOR *)

If[jiGenerators[{{1, 2, 4}, {0, -1, -4}}] == {{1, 2}, {0, -1}, {0, 0}}, "", fails = fails + 1; Print["jiGenerators[{{1, 2, 4}, {0, -1, -4}}] == {{1, 2}, {0, -1}, {0, 0}}"]];
If[jiGenerators[{{1, 1, 0}, {0, 1, 4}}] == {{1, 3}, {0, -3}, {0, 1}}, "", fails = fails + 1; Print["jiGenerators[{{1, 1, 0}, {0, 1, 4}}] == {{1, 3}, {0, -3}, {0, 1}}"]];
If[jiGenerators[{{1, 0, -4}, {0, 1, 4}}] == {{1, 0}, {0, 1}, {0, 0}}, "", fails = fails + 1; Print["jiGenerators[{{1, 0, -4}, {0, 1, 4}}] == {{1, 0}, {0, 1}, {0, 0}}"]];
If[jiGenerators[{{1, 2, 3}, {0, -3, -5}}] == {{0, 0}, {5, 3}, {-3, -2}}, "", fails = fails + 1; Print["jiGenerators[{{1, 2, 3}, {0, -3, -5}}] == {{0, 0}, {5, 3}, {-3, -2}}"]];



(* ___ PRIVATE ___ *)



(* LIST UTILITIES *)

(* extractGcd *)
If[extractGcd[{0, -6, 9}] == {0, -2, 3}, "", fails = fails + 1; Print["extractGcd[{0, -6, 9}] == {0, -2, 3}"]];
If[extractGcd[{-1, -2, -3}] == {-1, -2, -3}, "", fails = fails + 1; Print["extractGcd[{-1, -2, -3}] == {-1, -2, -3}"]];

(* multByLcd *)
If[multByLcd[{1 / 3, 1, 2 / 5}] == {5, 15, 6}, "", fails = fails + 1; Print["multByLcd[{1 / 3, 1, 2 / 5}] == {5, 15, 6}"]];

(* allZerosL *)
If[allZerosL[{0, -6, 9}] == False, "", fails = fails + 1; Print["allZerosL[{0, -6, 9}] == False"]];
If[allZerosL[{0, 0, 0}] == True, "", fails = fails + 1; Print["allZerosL[{0, 0, 0}] == True"]];


(* MATRIX UTILITIES *)

(* allZeros *)
If[allZeros[{{1, 0, -4}, {0, 1, 4}}] == False, "", fails = fails + 1; Print["allZeros[{{1, 0, -4}, {0, 1, 4}}] == False"]];
If[allZeros[{{0, 0, 0}, {0, 0, 0}}] == True, "", fails = fails + 1; Print["allZeros[{{0, 0, 0}, {0, 0, 0}}] == True"]];

(* reverseEachRow *)
If[reverseEachRow[{{1, 0, -4}, {0, 1, 4}}] == {{-4, 0, 1}, {4, 1, 0}}, "", fails = fails + 1; Print["reverseEachRow[{{1, 0, -4}, {0, 1, 4}}] == {{-4, 0, 1}, {4, 1, 0}}"]];

(* reverseEachCol *)
If[reverseEachCol[{{1, 0, -4}, {0, 1, 4}}] == {{0, 1, 4}, {1, 0, -4}}, "", fails = fails + 1; Print["reverseEachCol[{{1, 0, -4}, {0, 1, 4}}] == {{0, 1, 4}, {1, 0, -4}}"]];

(* antiTranspose *)
If[antiTranspose[{{1, 0, -4}, {0, 1, 4}}] == {{4, -4}, {1, 0}, {0, 1}}, "", fails = fails + 1; Print["antiTranspose[{{1, 0, -4}, {0, 1, 4}}] == {{4, -4}, {1, 0}, {0, 1}}"]];

(* removeAllZeroRows *)
If[removeAllZeroRows[{{1, 0, 0}, {0, 0, 0}, {1, 2, 3}}] == {{1, 0, 0}, {1, 2, 3}}, "", fails = fails + 1; Print["removeAllZeroRows[{{1, 0, 0}, {0, 0, 0}, {1, 2, 3}}] == {{1, 0, 0}, {1, 2, 3}}"]];
If[removeAllZeroRows[{{1, 0, 1}, {0, 0, 2}, {0, 0, 3}}] == {{1, 0, 1}, {0, 0, 2}, {0, 0, 3}}, "", fails = fails + 1; Print["removeAllZeroRows[{{1, 0, 1}, {0, 0, 2}, {0, 0, 3}}] == {{1, 0, 1}, {0, 0, 2}, {0, 0, 3}}"]];
If[removeAllZeroRows[{{12, 19, 28}, {24, 38, 56}}] == {{12, 19, 28}, {24, 38, 56}}, "", fails = fails + 1; Print["removeAllZeroRows[{{12, 19, 28}, {24, 38, 56}}] == {{12, 19, 28}, {24, 38, 56}}"]];
If[removeAllZeroRows[{{0, 0}, {0, 0}}] == {}, "", fails = fails + 1; Print["removeAllZeroRows[{{0, 0}, {0, 0}}] == {}"]];

(* removeUnneededZeroRows *)
If[removeUnneededZeroRows[{{1, 0, 0}, {0, 0, 0}, {1, 2, 3}}] == {{1, 0, 0}, {1, 2, 3}}, "", fails = fails + 1; Print["removeUnneededZeroRows[{{1, 0, 0}, {0, 0, 0}, {1, 2, 3}}] == {{1, 0, 0}, {1, 2, 3}}"]];
If[removeUnneededZeroRows[{{1, 0, 1}, {0, 0, 2}, {0, 0, 3}}] == {{1, 0, 1}, {0, 0, 2}, {0, 0, 3}}, "", fails = fails + 1; Print["removeUnneededZeroRows[{{1, 0, 1}, {0, 0, 2}, {0, 0, 3}}] == {{1, 0, 1}, {0, 0, 2}, {0, 0, 3}}"]];
If[removeUnneededZeroRows[{{12, 19, 28}, {24, 38, 56}}] == {{12, 19, 28}, {24, 38, 56}}, "", fails = fails + 1; Print["removeUnneededZeroRows[{{12, 19, 28}, {24, 38, 56}}] == {{12, 19, 28}, {24, 38, 56}}"]];
If[removeUnneededZeroRows[{{0, 0}, {0, 0}}] == {{0, 0}}, "", fails = fails + 1; Print["removeUnneededZeroRows[{{0, 0}, {0, 0}}] == {{0, 0}}"]];

(* rowCount *)
If[rowCount[{{0, 0}, {0, 0}}] == 2, "", fails = fails + 1; Print["rowCount[{{0, 0}, {0, 0}}] == 2"]];
If[rowCount[{{0}, {0}}] == 2, "", fails = fails + 1; Print["rowCount[{{0}, {0}}] == 2"]];
If[rowCount[{{0, 0}}] == 1, "", fails = fails + 1; Print["rowCount[{{0, 0}}] == 1"]];

(* colCount *)
If[colCount[{{0, 0}, {0, 0}}] == 2, "", fails = fails + 1; Print["colCount[{{0, 0}, {0, 0}}] == 2"]];
If[colCount[{{0}, {0}}] == 1, "", fails = fails + 1; Print["colCount[{{0}, {0}}] == 1"]];
If[colCount[{{0, 0}}] == 2, "", fails = fails + 1; Print["colCount[{{0, 0}}] == 2"]];


(* MAPPING & COMMA-BASIS UTILITIES *)

(* isSquare *)
If[isSquare[{{0, 0}, {0, 0}}] == True, "", fails = fails + 1; Print["isSquare[{{0, 0}, {0, 0}}] == True"]];
If[isSquare[{{0}, {0}}] == False, "", fails = fails + 1; Print["isSquare[{{0}, {0}}] == False"]];
If[isSquare[{{0, 0}}] == False, "", fails = fails + 1; Print["isSquare[{{0, 0}}] == False"]];

(* isCommaBasis *)
If[isCommaBasis[{{1, 0, -4}, {0, 1, 4}}] == False, "", fails = fails + 1; Print["isCommaBasis[{{1, 0, -4}, {0, 1, 4}}] == False"]];
If[isCommaBasis[{{1, 2}, {3, 4}, {5, 6}}] == True, "", fails = fails + 1; Print["isCommaBasis[{{1, 2}, {3, 4}, {5, 6}}] == True"]];
If[isCommaBasis[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}] == False, "", fails = fails + 1; Print["isCommaBasis[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}] == False"]];
If[isCommaBasis[{{1, 2}, {0, 0}, {0, 0}}] == True, "", fails = fails + 1; Print["isCommaBasis[{{1, 2}, {0, 0}, {0, 0}}] == True"]];
If[isCommaBasis[{{1, 0, 0}, {2, 0, 0}}] == False, "", fails = fails + 1; Print["isCommaBasis[{{1, 0, 0}, {2, 0, 0}}] == False"]];

(* isMapping *)
If[isMapping[{{1, 0, -4}, {0, 1, 4}}] == True, "", fails = fails + 1; Print["isMapping[{{1, 0, -4}, {0, 1, 4}}] == True"]];
If[isMapping[{{1, 2}, {3, 4}, {5, 6}}] == False, "", fails = fails + 1; Print["isMapping[{{1, 2}, {3, 4}, {5, 6}}] == False"]];
If[isMapping[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}] == False, "", fails = fails + 1; Print["isMapping[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}] == False"]];
If[isMapping[{{1, 2}, {0, 0}, {0, 0}}] == False, "", fails = fails + 1; Print["isMapping[{{1, 2}, {0, 0}, {0, 0}}] == False"]];
If[isMapping[{{1, 0, 0}, {2, 0, 0}}] == True, "", fails = fails + 1; Print["isMapping[{{1, 0, 0}, {2, 0, 0}}] == True"]];

(* noncanonicalNullSpaceBasis *)
If[noncanonicalNullSpaceBasis[{{19, 30, 44}}] == {{-30, -44}, {19, 0}, {0, 19}}, "", fails = fails + 1; Print["noncanonicalNullSpaceBasis[{{19, 30, 44}}] == {{-30, -44}, {19, 0}, {0, 19}}"]];

(* noncanonicalAntiNullSpaceBasis *)
If[noncanonicalAntiNullSpaceBasis[{{-30, -44}, {19, 0}, {0, 19}}] == {{19, 30, 44}}, "", fails = fails + 1; Print["noncanonicalAntiNullSpaceBasis[{{-30, -44}, {19, 0}, {0, 19}}] == {{19, 30, 44}}"]];


(* MATRIX FORMS & DEFACTORING: DESIGNED FOR MAPPINGS *)

(* hnf *)
If[hnf[{{5, 8, 12}, {7, 11, 16}}] == {{1, 0, -4}, {0, 1, 4}}, "", fails = fails + 1; Print["hnf[{{5, 8, 12}, {7, 11, 16}}] == {{1, 0, -4}, {0, 1, 4}}"]];
If[hnf[{{3, 0, -1}, {0, 3, 5}}] == {{3, 0, -1}, {0, 3, 5}}, "", fails = fails + 1; Print["hnf[{{3, 0, -1}, {0, 3, 5}}] == {{3, 0, -1}, {0, 3, 5}}"]];

(* snf *)
If[snf[{{1, 1, 0, -3}, {0, 3, 12, 30}}] == {{1, 0, 0, 0}, {0, 3, 0, 0}}, "", fails = fails + 1; Print["snf[{{1, 1, 0, -3}, {0, 3, 12, 30}}] == {{1, 0, 0, 0}, {0, 3, 0, 0}}"]];

(* rref *)
If[rref[{{7, 11, 16}, {22, 35, 51}}] == {{1, 0, -1 / 3}, {0, 1, 5 / 3}}, "", fails = fails + 1; Print["rref[{{7, 11, 16}, {22, 35, 51}}] == {{1, 0, -1 / 3}, {0, 1, 5 / 3}}"]];

(* irref *)
If[irref[{{7, 11, 16}, {22, 35, 51}}] == {{3, 0, -1}, {0, 3, 5}}, "", fails = fails + 1; Print["irref[{{7, 11, 16}, {22, 35, 51}}] == {{3, 0, -1}, {0, 3, 5}}"]];

(* rightReducingMatrix *)
If[rightReducingMatrix[{{6, 5, -4}, {4, -4, 1}}] == {{1, -2, 1}, {1, 1, 2}, {2, 1, 4}}, "", fails = fails + 1; Print["rightReducingMatrix[{{6, 5, -4}, {4, -4, 1}}] == {{1, -2, 1}, {1, 1, 2}, {2, 1, 4}}"]];

(* smithDefactor *)
If[smithDefactor[{{6, 5, -4}, {4, -4, 1}}] == {{2, 9, -5}, {0, 2, -1}}, "", fails = fails + 1; Print["smithDefactor[{{6, 5, -4}, {4, -4, 1}}] == {{2, 9, -5}, {0, 2, -1}}"]];

(* hermiteRightUnimodular *)
If[hermiteRightUnimodular[{{6, 5, -4}, {4, -4, 1}}] == {{1, 2, 1}, {-1, 0, 2}, {0, 3, 4}}, "", fails = fails + 1; Print["hermiteRightUnimodular[{{6, 5, -4}, {4, -4, 1}}] == {{1, 2, 1}, {-1, 0, 2}, {0, 3, 4}}"]];

(* colHermiteDefactor *)
If[colHermiteDefactor[{{6, 5, -4}, {4, -4, 1}}] == {{6, 5, -4}, {-4, -4, 3}}, "", fails = fails + 1; Print["colHermiteDefactor[{{6, 5, -4}, {4, -4, 1}}] == {{6, 5, -4}, {-4, -4, 3}}"]];

(* canonicalMapping *)
If[canonicalMapping[{{5, 8, 12}, {7, 11, 16}}] == {{1, 0, -4}, {0, 1, 4}}, "", fails = fails + 1; Print["canonicalMapping[{{5, 8, 12}, {7, 11, 16}}] == {{1, 0, -4}, {0, 1, 4}}"]];
If[canonicalMapping[{{0, 0, 0}}] == {{0, 0, 0}}, "", fails = fails + 1; Print["canonicalMapping[{{0, 0, 0}}] == {{0, 0, 0}}"]];

(* MEET AND JOIN *)

If[getMapping[{{1, 0, -4}, {0, 1, 4}}] == {{1, 0, -4}, {0, 1, 4}}, "", fails = fails + 1; Print["getMapping[{{1, 0, -4}, {0, 1, 4}}] == {{1, 0, -4}, {0, 1, 4}}"]];
If[getMapping[{{4}, {-4}, {1}}] == {{1, 0, -4}, {0, 1, 4}}, "", fails = fails + 1; Print["getMapping[{{4}, {-4}, {1}}] == {{1, 0, -4}, {0, 1, 4}}"]];

If[getCommaBasis[{{1, 0, -4}, {0, 1, 4}}] == {{4}, {-4}, {1}}, "", fails = fails + 1; Print["getCommaBasis[{{1, 0, -4}, {0, 1, 4}}] == {{4}, {-4}, {1}}"]];
If[getCommaBasis[{{4}, {-4}, {1}}] == {{4}, {-4}, {1}}, "", fails = fails + 1; Print["getCommaBasis[{{4}, {-4}, {1}}] == {{4}, {-4}, {1}}"]];




Print["TOTAL FAILURES: ", fails];
