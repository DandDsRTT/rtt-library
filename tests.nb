Print["\n\n MAPPING & COMMA-BASIS UTILITIES"];


Print["\n dimensionality"];
dimensionality[{{0}}] == 1
dimensionality[{{0, 0}}] == 2
dimensionality[{{0}, {0}}] == 2
dimensionality[IdentityMatrix[2]] == 2
dimensionality[{{1, 0, -4}, {0, 1, 4}}] == 3
dimensionality[{{4}, {-4}, {1}}] == 3
dimensionality[{{1, 0, -4, 0}, {0, 1, 4, 0}}] == 4
dimensionality[{{4}, {-4}, {1}, {0}}] == 4

Print["\n rank"];
rank[{{0}}] == Error
rank[{{0, 0}}] == 0
rank[{{0}, {0}}] == 2
rank[IdentityMatrix[2]] == Error
rank[{{1, 0, -4}, {0, 1, 4}}] == 2
rank[{{4}, {-4}, {1}}] == 2
rank[{{1, 0, -4, 0}, {0, 1, 4, 0}}] == 2
rank[{{4}, {-4}, {1}, {0}}] == 3

Print["\n nullity"];
nullity[{{0}}] == Error
nullity[{{0, 0}}] == 2
nullity[{{0}, {0}}] == 0
nullity[IdentityMatrix[2]] == Error
nullity[{{1, 0, -4}, {0, 1, 4}}] == 1
nullity[{{4}, {-4}, {1}}] == 1
nullity[{{1, 0, -4, 0}, {0, 1, 4, 0}}] == 2
nullity[{{4}, {-4}, {1}, {0}}] == 1


Print["\n\n MATRIX FORMS & DEFACTORING"];

Print["\n canonicalForm"];
canonicalForm[{{12, 19}, {0, 0}, {0, 0}}] == {{1}, {0}, {0}}
canonicalForm[{{1, 1, 0}, {0, 1, 4}}] == {{1, 0, -4}, {0, 1, 4}}
canonicalForm[{{12, 19, 28}}] == {{12, 19, 28}}
canonicalForm[{{7, 11, 16}, {22, 35, 51}}] == {{1, 2, 3}, {0, 3, 5}}
canonicalForm[{{3, 0, -1}, {0, 3, 5}}] == {{1, 2, 3}, {0, 3, 5}}
canonicalForm[{{1, 2, 3}, {0, 3, 5}}] == {{1, 2, 3}, {0, 3, 5}}
canonicalForm[{{0, 1, 4, 10}, {1, 0, -4, -13}}] == {{1, 0, -4, -13}, {0, 1, 4, 10}}
canonicalForm[{{10, 13, 12, 0}, {-1, -1, 0, 3}}] == {{1, 0, -4, -13}, {0, 1, 4, 10}}
canonicalForm[{{5, 8, 0}, {0, 0, 1}}] == {{5, 8, 0}, {0, 0, 1}}
canonicalForm[{{2, 0, 11, 12}, {0, 1, -2, -2}}] == {{2, 0, 11, 12}, {0, 1, -2, -2}}
canonicalForm[{{1, 0, 0, -5}, {0, 1, 0, 2}, {0, 0, 1, 2}}] == {{1, 0, 0, -5}, {0, 1, 0, 2}, {0, 0, 1, 2}}
canonicalForm[{{1, 0, 0, -5, 12}, {0, 1, 0, 2, -1}, {0, 0, 1, 2, -3}}] == {{1, 0, 0, -5, 12}, {0, 1, 0, 2, -1}, {0, 0, 1, 2, -3}}
canonicalForm[{{12, 19, 28}, {26, 43, 60}}] == {{1, 8, 0}, {0, 11, -4}}
canonicalForm[{{17, 16, -4}, {4, -4, 1}}] == {{1, 0, 0}, {0, 4, -1}}
canonicalForm[{{6, 5, -4}, {4, -4, 1}}] == {{2, 1, -1}, {0, 2, -1}}
canonicalForm[{{12, 19, 28}, {0, 0, 0}}] == {{12, 19, 28}}
canonicalForm[{{1, 0, 0, -5}, {0, 1, 0, 2}, {1, 1, 0, -3}}] == {{1, 0, 0, -5}, {0, 1, 0, 2}}
canonicalForm[{{0, 0}}] == {{0, 0}}
canonicalForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}] == {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}
canonicalForm[{{12, 19, 28, 0}}] == {{12, 19, 28, 0}}


Print["\n\n DUAL"];

Print["\n nullSpaceBasis"];
nullSpaceBasis[{{1, 0, -4}, {0, 1, 4}}] == {{4}, {-4}, {1}}
nullSpaceBasis[{{0}}] == IdentityMatrix[1]
nullSpaceBasis[{{0, 0}}] == IdentityMatrix[2]
nullSpaceBasis[{{0, 0, 0}}] == IdentityMatrix[3]
nullSpaceBasis[IdentityMatrix[3]] == {{0}, {0}, {0}}

Print["\n antiNullSpaceBasis"];
antiNullSpaceBasis[ {{4}, {-4}, {1}}] == {{1, 0, -4}, {0, 1, 4}}
antiNullSpaceBasis[{{1, 0}, {0, -4}, {0, 9}}] == {{0, 9, 4}}
antiNullSpaceBasis[{{0}}] == IdentityMatrix[1]
antiNullSpaceBasis[{{0}, {0}}] == IdentityMatrix[2]
antiNullSpaceBasis[{{0}, {0}, {0}}] == IdentityMatrix[3]
antiNullSpaceBasis[IdentityMatrix[3]] == {{0, 0, 0}}

Print["\n dual"];
verifyDuals[m_, c_, debug_ : False] := Module[{dualM, dualC},
  dualC = dual[m, "mapping"];
  dualM = dual[c, "commaBasis"];

  If[debug == True, Print["dualC: ", dualC, " c: ", c, " dualM: ", dualM, " m: ", m]];

  dualC == canonicalForm[c] && dualM == canonicalForm[m]
];

verifyDuals[{{1, 0, -4}, {0, 1, 4}}, {{4}, {-4}, {1}}]
verifyDuals[{{0}}, {{1}}]
verifyDuals[{{0, 0}}, {{1, 0}, {0, 1}}]
verifyDuals[{{0, 0, 0}}, {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}]
verifyDuals[{{1}}, {{0}}]
verifyDuals[{{1, 0}, {0, 1}}, {{0}, {0}}]
verifyDuals[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}, {{0}, {0}, {0}}]
verifyDuals[{{12, 19}}, {{-19}, {12}}]
